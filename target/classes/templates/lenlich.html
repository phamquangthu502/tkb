<!DOCTYPE html>
<html>
<head>
	<title>Lên lịch học</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="/postrequest.js"></script>
    <script src="/search.js"></script>
    <style type="text/css">
    .navbar-dark .navbar-nav .nav-link:focus, .navbar-dark .navbar-nav .nav-link:hover {
	    color: rgb(255, 255, 255);
	}
	</style>
</head>
<body>
	<header>
        <div class="title">
            <div class="row">
                <div class="col-9">
                    <h2>HỆ THỐNG QUẢN LÝ ĐÀO TẠO</h2>
                </div>
                <div class="col-3 acc">
                    <span><i class="fa fa-user-circle" aria-hidden="true"></i></span>
                    <span class="acc-name"></span>                   
                    <span>
                        <div class="dropdown dropleft">
                            <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown"></button>
                            <div class="dropdown-menu">
                            <!--  <a class="dropdown-item" href="#">Tài khoản</a>
                            <a class="dropdown-item" href="#">Thay đổi mật khẩu</a>-->
                            <a class="dropdown-item" href="/logout">Đăng xuất</a>
                            </div>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <nav class="navbar navbar-expand-sm bg-info navbar-dark">
            <div class="container" id="mynav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/lenlich">Trang chủ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#">Quản lý sinh viên</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link disabled" href="#">Quản lý giảng viên</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/lenlich">Lên thời khóa biểu</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link disabled" href="#">Đăng ký lịch dạy</a>
                    </li>
                    <li class="nav-item" >
                        <a class="nav-link disabled" href="#">Đăng ký lịch học</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <schedule>
        <div class="container">
            <div class="s-title">
                <h4>Lên lịch thời khóa biểu</h4>
            </div>
            <div class="s-body">
            	<div class="form-group" style="margin:20px 0px;">
                    <div class="chonhk" style="width:80%; display: flex; flex-wrap: wrap;">
                        <div class="chonhk1" style="line-height: 38px;margin-right: 20px;">
                            <label for="tenmon" class="">Chọn học kỳ: </label>
                        </div>
                        <div class="chonhk2" style="width: 250px;">
                            <select class="form-control" name="semester" id="semester">
                            	<option selected></option>
                            	<!--<option selected></option>
                            	  <option th:each="semester: ${semesters}" th:text="${semester}"></option> -->
                            </select>
                      
                        </div>
                    </div>
                </div>

                  <div class="row" style="margin: 30px 0px 5px 0px;">
                	<div class="col-4" style="padding: 0px;">
                	    <button class="btn btn-info btnadd" disabled type="button" ><i class="fa fa-plus" aria-hidden="true" style="margin-right: 5px;"></i>Thêm lịch</button>
                		
                	</div> 
                	<div class="col-8">
                		<form class="form-inline" th:action="@{/search}">
                			<input class="form-control mr-sm-2" type="text" name="inpkyhoc" th:value="${inpkyhoc}" id="inpkyhoc" hidden>
		                    <input class="form-control mr-sm-2" type="text" name="keyword" th:value="${keyword}" placeholder="Nhập tên môn học">
		                    <button class="btn btn-info btnsearch" disabled type="submit" data-toggle="tooltip" title="Tìm kiếm"><i class="fa fa-search" aria-hidden="true"></i></button>
		                </form>
                	</div>
                </div> 
                <!--<form class="form-inline" th:action="@{/search}">
                    <input class="form-control mr-sm-2" type="text" name="keyword" th:value="${keyword}" placeholder="Nhập tên môn học">
                    <button class="btn btn-info" type="submit" data-toggle="tooltip" title="Tìm kiếm"><i class="fa fa-search" aria-hidden="true"></i></button>
                </form>
                <button class="btn btn-info btnadd" type="button" data-toggle="modal" data-target="#addModal"><i class="fa fa-plus" aria-hidden="true" style="margin-right: 5px;"></i>Thêm lịch</button>
                -->
                
                <h4>Danh sách lịch học</h4>
                <div class="table-responsive">
                    <table class="table table-bordered" id="datatb">
                        <thead class="head-table">
                            <tr>
                            	
                                <th width="60px">MãMH</th>
                                <th>Tên môn</th>
                                <th>Giảng viên</th>
                                <th>Nhóm</th>
                                <th>TTH</th>
                                <th>STC</th>
                                <th>Mã lớp</th>
                                <th>Sĩ số</th>
                                <th>Thứ</th>
                                <th>TiếtBD</th>
                                <th>Số tiết</th>
                                <th>Phòng</th>
                                <th colspan="3">Hành động</th>
                            </tr>
                        </thead>
                        <tbody>
                             <tr th:each="schedule : ${listSchules}"> 	
                             	
								<th th:text="${schedule.subject_id}"></th>
                                <th th:text="${schedule.names}"></th>
                                <th th:text="${schedule.namel}"></th>
                                <th th:text="${schedule.nhom}"></th>
                                <th th:text="${schedule.tth}"></th>
                                <th th:text="${schedule.stc}"></th>
                                <th th:text="${schedule.malop}"></th>
                                <th th:text="${schedule.siso}"></th>
                                <th th:text="${schedule.thu}"></th>
                                <th th:text="${schedule.tietbd}"></th>
                                <th th:text="${schedule.sotiet}"></th>
                                <th th:text="${schedule.namer}"></th>
                                <th>
                                	<a th:href="@{/schule/(id=${schedule.id})}"  title="Sửa" class="btnEdit">
                                		<i class="fa fa-pencil" aria-hidden="true"></i>
                                	</a>
                                	
                                </th>
                                <th>
                                	<a th:href="@{/delete/(id=${schedule.id})}" data-toggle="tooltip" title="Xóa" class="btnDel">
                                		<i class="fa fa-trash" aria-hidden="true"></i>
                                	</a>
                                	
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="modal" tabindex="-1" role="dialog" id="deleteModal">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title">Bạn muốn xóa không?</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
			      </div>
			      <div class="modal-footer">
			        <a href="" type="button" class="btn btn-danger" id="delid">Xóa</a>
			        <button type="button" class="btn btn-warning" data-dismiss="modal">Hủy</button>
			      </div>
			    </div>
			  </div>
			</div>
    </schedule>
    <footer>Coppyright by @Team 19</footer>
    <!-- The Add Modal -->
    <div class="modal" id="addModal">
        <div class="modal-dialog">
        	<div class="modal-content">
	            <!-- Modal body -->
	            <div class="modal-body">
	                <button type="button" class="close " data-dismiss="modal">&times;</button>
	                <div class="dangnhap">
	                    <div class="tit"><h2 id="titmodal">Thêm thông tin lịch học</h2></div>
	                    <form id="addSchu">	
		                    <div class="form-group " hidden>
		                    	<div class="row">
		                    		<input style="text-align:center;" type="text" class="form-control" id="idky" placeholder="" name="idky" >
		                    	</div>
	                    	</div>
	                    	
	                        <div class="form-group ">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Mã môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="subject_id" placeholder="" name="subject_id" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="tenmon" class="">Tên môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="names" placeholder="" name="names" disabled >
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Mã giảng viên</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="lecturers_id" placeholder="" name="lecturers_id" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Tên giảng viên</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="namel" placeholder="" name="namel" disabled>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="nhommon" class="">Nhóm môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="nhom" placeholder="" name="nhom" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="to" class="">Tổ thực hành</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="tth" name="tth">
								    		<option>0</option>
								    		<option>1</option>
								    		<option>2</option>
								    		<option>3</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="tinchi" class="">Số tín chỉ</label>
	                                </div>
	                                <div class="col-8">
	                                    
	                                    <select class="form-control" id="stc" name="stc">
								    		<option>1</option>
								    		<option>2</option>
								    		<option>3</option>
								    		<option>4</option>
								    		<option>6</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="idlop" class="">Mã lớp</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="malop" placeholder="" name="malop" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="siso" class="">Sĩ số</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="siso" placeholder="" name="siso" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Thứ</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="thu" name="thu">
								    		<option>Monday</option>
								    		<option>Tuesday</option>
								    		<option>Wednesday</option>
								    		<option>Thursday</option>
								    		<option>Friday</option>
								    		<option>Saturday</option>
								    		<option>Sunday</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Tiết bắt đầu</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="tietbd" name="tietbd" required></select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Số tiết</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="sotiet" name="sotiet" required>
								    		<option>2</option>
								    		<option>4</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	                
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="phong" class="">Phòng học</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="namer" name="namer" required></select>
	                                </div>
	                            </div>
	                        </div>
	                        <div class="row btnmodal">
	                            <div class="col-4"><button type="submit" class="btn btn-success" id="btnAdd"><i class="fa fa-floppy-o" aria-hidden="true"></i> Thêm</button></div>
	                            <div class="col-4"><button type="reset" class="btn btn-primary" id="btnReset"><i class="fa fa-refresh" aria-hidden="true"></i> Clear</button></div>
	                            <div class="col-4"><button type="button" class="btn btn-danger" onclick="exitT()"><i class="fa fa-sign-out" aria-hidden="true"></i> Thoát</button></div>
	                        </div>
	                    </form>
	    
	                </div>
	            </div>
		            
	            <!-- Modal footer -->
	            <div class="footer">
	                <span>Nhập đủ thông tin ở các trường bắt buộc(<span class="note">*</span>)</span>
	            </div>
	        </div>
    	</div>
    </div>
    
    <!-- The Modal -->
    <div class="modal" id="myModal">
        <div class="modal-dialog">
        	<div class="modal-content">
            
	            <!-- Modal body -->
	            <div class="modal-body">
	                <button type="button" class="close " data-dismiss="modal">&times;</button>
	                <div class="dangnhap">
	                    <div class="tit"><h2 id="titmodal">Sửa thông tin lịch học</h2></div>
	                    <form id="editForm">	
	                    	<input type="text" class="form-control" id="uidky" placeholder="" name="uidky" hidden>
	                    	<div class="form-group ">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">ID</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="id" name="id" required disabled>
	                                </div>
	                            </div>
	                        </div>
	                        <div class="form-group ">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Mã môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="usubject_id" name="subject_id" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="tenmon" class="">Tên môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="unames" placeholder="" name="names" disabled>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Mã giảng viên</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="ulecturers_id" placeholder="" name="lecturers_id" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="email2" class="">Tên giảng viên</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="unamel" placeholder="" name="namel" disabled >
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="nhommon" class="">Nhóm môn học</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="unhom" placeholder="" name="nhom" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="to" class="">Tổ thực hành</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="utth" name="tth">
								    		<option>0</option>
								    		<option>1</option>
								    		<option>2</option>
								    		<option>3</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="tinchi" class="">Số tín chỉ</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="ustc" name="ustc">
								    		<option>1</option>
								    		<option>2</option>
								    		<option>3</option>
								    		<option>4</option>
								    		<option>6</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="idlop" class="">Mã lớp</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="umalop" placeholder="" name="malop" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="siso" class="">Sĩ số</label>
	                                </div>
	                                <div class="col-8">
	                                    <input type="text" class="form-control" id="usiso" placeholder="" name="siso" required>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Thứ</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="uthu" name="uthu">
								    		<option>Monday</option>
								    		<option>Tuesday</option>
								    		<option>Wednesday</option>
								    		<option>Thursday</option>
								    		<option>Friday</option>
								    		<option>Saturday</option>
								    		<option>Sunday</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Tiết bắt đầu</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="utietbd" name="tietbd" required></select>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="thu" class="">Số tiết</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="usotiet" name="sotiet">
								    		<option>2</option>
								    		<option>4</option>
								 	 	</select>
	                                </div>
	                            </div>
	                        </div>
	                
	                        <div class="form-group">
	                            <div class="row">
	                                <div class="col-4">
	                                    <label for="phong" class="">Phòng học</label>
	                                </div>
	                                <div class="col-8">
	                                    <select class="form-control" id="unamer" name="namer" required></select>
	                                </div>
	                            </div>
	                        </div>
	                        <div class="row btnmodal">
	                            <div class="col-6"><button type="submit" class="btn btn-primary" id="btnLuu"><i class="fa fa-floppy-o" aria-hidden="true"></i> Lưu</button></div>
	                            <div class="col-6"><button type="button" class="btn btn-danger" onclick="exitT()"><i class="fa fa-sign-out" aria-hidden="true"></i> Thoát</button></div>
	                        </div>
	                    </form>
	    
	                </div>
	            </div>
		            
	            <!-- Modal footer -->
	            <div class="footer">
	                <span>Nhập đủ thông tin ở các trường bắt buộc(<span class="note">*</span>)</span>
	            </div>
	        </div>
    	</div>
    </div>
    <script>
        
        $(document).ready( function () {
        	
        	var x = sessionStorage.getItem("username");
	    	$(".acc-name").text(x);
	    	
            $('[data-toggle="tooltip"]').tooltip(); 
            //<th th:text="${schedule.id}"></th>    <th>ID</th>
            var firstr = [];
            var listhk = [];
            $.ajax({
        		  url: "listrr",
        		  type: "get", //send it through get method
        		  data: { 
        		  },
        		  success: function(response) {
         		  		for(var i=0; i<response.length;i++){
     						firstr.push(response[i]);
     					}
        		  },
        		  error: function(xhr) {
        		  		        		  
        		  }
        	});
            var xa = $('#inpkyhoc').val();    
            $('#semester').val(xa);
            $('#uidky').val(xa);
            var xs = $('#semester').val();  
            
            if(xs!=""){
            	$(".btnadd").attr("disabled", false);
            	$(".btnsearch").attr("disabled", false);
            	$('#idky').val(xa);
            }
            $.ajax({
	      		  url: "listhk",
	      		  type: "get", //send it through get method
	      		  data: { 
	      		  },
	      		  success: function(response) {
	       		  		for(var i=0; i<response.length;i++){
	       		  			listhk.push(response[i]);
	   					}
	       		  		
		       		  	for (i = 0; i < listhk.length; i++)
	                	{ 
	                		   	if(xa=="") $('#semester').append('<option value="'+listhk[i]+'">'+listhk[i]+'</option>');
	                		   	else{
	                		   		if(listhk[i]==xa){ 
	                		   			$('#semester').append('<option selected="selected" value="'+listhk[i]+'">'+listhk[i]+'</option>');
	                		   		}
	                		   		else $('#semester').append('<option value="'+listhk[i]+'">'+listhk[i]+'</option>');
	                		   	}
	                	}
	      		  },
	      		  error: function(xhr) {
	      		  		        		  
	      		  }
	      	});
            //var x = $("#semester").val();
        	//alert(x);
      
        	$(".btnadd").on('click', function(){
        		event.preventDefault();
        		$("#addModal").modal();
        		$("#subject_id").val("");
				$("#lecturers_id").val(""),
				$("#nhom").val(""),
				$("#malop").val(""),
				$("#siso").val("")
        	});
        	$('#delid').on('click',function(){
        		location.reload();
        	});
        	$('.btnDel').on('click',function(event){
            	
        		event.preventDefault();
            	//$('#deleteModal #delid').attr('href', href);           		
            	$('#deleteModal').modal();
            	var href = $(this).attr('href');
            	var href = $(this).attr('href');
            	var href2 = href.replace('"','=').split('=');
            	var idx = parseInt(href2[1]);
        		$.ajax({
           		  	url: "delete",
           		  	type: "get", //send it through get method
           		  	data: { 
           		    	id: idx
           		  	},
           		  	success: function(response) {
           		  		if(response==null){
           		  		}
           		  	},
           		  	error: function(xhr) {
           		  //	//	        		  
           			}
           		});
            });
        	
        	function Xoa(event){
        		event.preventDefault();
        		var href = $(this).attr('href');
            	var href = $(this).attr('href');
            	var href2 = href.replace('"','=').split('=');
            	var idx = parseInt(href2[1]);
        		$.ajax({
           		  	url: "delete",
           		  	type: "get", //send it through get method
           		  	data: { 
           		    	id: idx
           		  	},
           		  	success: function(response) {
           		  		if(response==null){
           		  		}
           		  	},
           		  	error: function(xhr) {
           		  //	//	        		  
           			}
           		});
        	}
        	
        	
            $('#semester').on('change',function(){
            	var x = $("#semester").val();
            	if(x!="") {
                	$(".btnadd").attr("disabled", false);
                	$(".btnsearch").attr("disabled", false);
                }
            	else{
            		$(".btnadd").attr("disabled", true);
                	$(".btnsearch").attr("disabled", true);
            	}
            	//alert(x);
            	$('#inpkyhoc').val(x);
            	$('#idky').val(x);
            	$("#datatb tbody").empty();
            });
            
            
          	//______________________Modal Thêm_____________________
          	var temp3=0;
            var temp4=0;
            //--chọn phòng
            $('#namer').on('click',function(){
            	var thu = $("#thu").val();
            	var tietbd = $("#tietbd").val();
            	var ky = $("#inpkyhoc").val();
            	temp3++;
            	if((temp3 % 2)==1){   
            		$('#namer').empty();
            		$.ajax({
               		  	url: "listr",
               		  	type: "get", //send it through get method
               		  	data: { 
               		    	thu: thu,
               		    	tietbd: tietbd,
               		    	ky: ky
               		  	},
               		  	success: function(response) {
               		  		var secondr = [];
               		  		var z = response.length;
               				for(var i=0; i<z;i++){
               					secondr.push(response[i].namer);
               				}
               				var difference = firstr.filter(x => secondr.indexOf(x) === -1);
                        	for (i = 0; i < difference.length; i++)
                        	{ 
                        		   $('#namer').append('<option value="'+difference[i]+'">'+difference[i]+'</option>');
                        	}
                     
               		  	},
               		  	error: function(xhr) {
               		  		        		  
               			}
               		});
            	}
            });
            
            //chọn tiết bắt đầu(idgv,thu)
            $('#tietbd').on('click',function(event){
            	var idl = $("#lecturers_id").val();
            	var thu = $("#thu").val();
            	var ky = $("#inpkyhoc").val();
            	var first = [ 1, 3, 5, 7, 9, 11 ];
            	temp4++;
            	if((temp4 % 2)==1){
	            	$('#tietbd').empty();
					$.ajax({
	           		  	url: "listtbd",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	idl: idl,
	           		    	thu: thu,
	           		    	ky: ky
	           		  	},
	           		  	success: function(response) {
	           		  		
	           		  		var second = [];
	           		  		var z = response.length;
	           				for(var i=0; i<z;i++){
	           					second.push(response[i].tietbd);
	           				}
	           				var difference1 = first.filter(x => second.indexOf(x) === -1);
	                    	for (i = 0; i < difference1.length; i++)
	                    	{ 
	                    	     $('#tietbd').append( '<option value="'+difference1[i]+'">'+difference1[i]+'</option>' );
	                    	}
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            
            $('#thu').on('change',function(){
            	$("#tietbd").val('');
            	$("#namer").val('');
            });
            
			$('#tietbd').on('change',function(){
				$("#namer").val('');
            });
          	
			$('#lecturers_id').on('change',function(){
				$("#tietbd").val('');
            });
            
            //______________________Modal Sửa_____________________
            var temp1=0;
            var temp2=0;
            //--chọn phòng
            $('#unamer').on('click',function(){
            	var room = $("#unamer").val();
            	var thu = $("#uthu").val();
            	var tietbd = $("#utietbd").val();
            	var ky = $("#inpkyhoc").val();
            	temp1++;
            	console.log('temp1:'+temp1);
            	if((temp1 % 2)==1){   
            		$('#unamer').empty();
            		$.ajax({
               		  	url: "listr",
               		  	type: "get", //send it through get method
               		  	data: { 
               		    	thu: thu,
               		    	tietbd: tietbd,
               		    	ky: ky
               		  	},
               		  	success: function(response) {
               		  		var secondr = [];
               		  		var z = response.length;
               				for(var i=0; i<z;i++){
               					if(response[i].namer != room) secondr.push(response[i].namer);				
               				}
               				var difference = firstr.filter(x => secondr.indexOf(x) === -1);
                        	console.log(difference);
                        	//$('#unamer').append('<option value="'+$("#unamer").val()+'">'+$("#unamer").val()+'</option>');
                        	for (i = 0; i < difference.length; i++)
                        	{ 
                        		   $('#unamer').append('<option value="'+difference[i]+'">'+difference[i]+'</option>');
                        	}
                     
               		  	},
               		  	error: function(xhr) {
               		  		        		  
               			}
               		});
            	}
            });
            
            //chọn tiết bắt đầu(idgv,thu)
            $('#utietbd').on('click',function(event){
            	var tietbd = $("#utietbd").val();
            	var idl = $("#ulecturers_id").val();
            	var thu = $("#uthu").val();
            	var ky = $("#inpkyhoc").val();
            	var first = [ 1, 3, 5, 7, 9, 11 ];
            	temp2++;
            	console.log('temp2:'+temp2);
            	if((temp2 % 2)==1){
	            	$('#utietbd').empty();
					$.ajax({
	           		  	url: "listtbd",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	idl: idl,
	           		    	thu: thu,
	           		    	ky: ky
	           		  	},
	           		  	success: function(response) {
	           		  		
	           		  		var second = [];
	           		  		var z = response.length;
	           				for(var i=0; i<z;i++){
	           					if(response[i].tietbd != tietbd) second.push(response[i].tietbd);
	           				}
	           				var difference1 = first.filter(x => second.indexOf(x) === -1);
	                    	console.log(difference1);
	                    	for (i = 0; i < difference1.length; i++)
	                    	{ 
	                    	     $('#utietbd').append( '<option value="'+difference1[i]+'">'+difference1[i]+'</option>' );
	                    	}
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            $('#uthu').on('change',function(){
            	$("#utietbd").val('');
            	$("#unamer").val('');
            });
            
			$('#utietbd').on('change',function(){
				$("#unamer").val('');
            });
          	
			$('#ulecturers_id').on('change',function(){
				$("#utietbd").val('');
            });
            
          //__________________nhập id -> tên của cả modal thêm, sửa_________________
            
          
	          $("#malop").focusout(function(){
	          	var mal = $(this).val();
	          	var ky = $("#inpkyhoc").val();
            	$.ajax({
           		  	url: "malop",
           		  	type: "get", //send it through get method
           		  	data: { 
           		    	id: mal,
           		    	ky: ky
           		  	},
           		  	success: function(response) {
           		  		if(response!=""){
	           		  		if (window.confirm('Mã lớp bị trùng. Bạn muốn thoát?')){    
	                    	    $("#malop").val('');
	                    	} 
           		  		}
           		  	},
           		  	error: function(xhr) {
           		  		        		  
           			}
           		});
	          });
	          $("#umalop").focusout(function(){
	          	var mal = $(this).val();
	          	var ky = $("#inpkyhoc").val();
            	$.ajax({
           		  	url: "malop",
           		  	type: "get", //send it through get method
           		  	data: { 
           		    	id: mal,
           		    	ky: ky
           		  	},
           		  	success: function(response) {
         			
       					if(response!=""){
		           		  	if (window.confirm('Mã lớp bị trùng. Bạn muốn thoát?')){    
		                    	 $("#umalop").val('');
		                    } 
 	           		  	}
                		  		
           		  		
           		  	},
           		  	error: function(xhr) {
           		  		        		  
           			}
           		});
	          });
          
            $("#usubject_id").focusout(function(){
            	var mamh = $(this).val();
            	if(isNaN(mamh)){
            		if (window.confirm('Lỗi! Mã môn học phải là số. Bạn muốn thoát?')){    
                	    $("#usubject_id").val('');
                	    $("#unames").val('');
                	} 
            	}
            	else{
	            	$.ajax({
	           		  	url: "subject",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	id: mamh
	           		  	},
	           		  	success: function(response) {
	           		  		if(response==null){
		           		  		if (window.confirm('Không tồn tại mã môn học. Bạn muốn thoát?')){    
		                    	    $("#usubject_id").val('');
		                    	    $("#unames").val('');
		                    	} 
	           		  		}
	           		  		else $('#unames').val(response.name_sub);
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            
            $("#subject_id").focusout(function(){
            	var mamh = $(this).val();
            	if(isNaN(mamh)){
            		if (window.confirm('Lỗi! Mã môn học phải là số. Bạn muốn thoát?')){    
                	    $("#subject_id").val('');
                	    $("#names").val('');
                	} 
            	}
            	else{
	            	$.ajax({
	           		  	url: "subject",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	id: mamh
	           		  	},
	           		  	success: function(response) {
	           		  		if(response==null){
		           		  		if (window.confirm('Không tồn tại mã môn học. Bạn muốn thoát?')){    
		                    	    $("#subject_id").val('');
		                    	    $("#names").val('');
		                    	} 
	           		  		}
	           		  		else $('#names').val(response.name_sub);
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            
            $("#ulecturers_id").focusout(function(){
            	
            	var magv = $(this).val();
            	if(isNaN(magv)){
            		if (window.confirm('Lỗi! Mã giảng viên phải là số. Bạn muốn thoát?')){    
                	    $("#ulecturers_id").val('');
                	    $("#unamel").val('');
                	} 
            	}
            	else{
	            	$.ajax({
	           		  	url: "lecturer",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	id: magv
	           		  	},
	           		  	success: function(response) {
	           		  		if(response==null){
		           		  		if (window.confirm('Không tồn tại mã giảng viên. Bạn muốn thoát?')){    
		                    	    $("#ulecturers_id").val('');
		                    	    $("#unamel").val('');
		                    	} 
	           		  		}
	           		  		else $('#unamel').val(response.name);
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            
            $("#lecturers_id").focusout(function(){
            	
            	var magv = $(this).val();
            	if(isNaN(magv)){
            		if (window.confirm('Lỗi! Mã giảng viên phải là số. Bạn muốn thoát?')){    
                	    $("#lecturers_id").val('');
                	    $("#namel").val('');
                	} 
            	}
            	else{
	            	$.ajax({
	           		  	url: "lecturer",
	           		  	type: "get", //send it through get method
	           		  	data: { 
	           		    	id: magv
	           		  	},
	           		  	success: function(response) {
	           		  		if(response==null){
		           		  		if (window.confirm('Không tồn tại mã giảng viên. Bạn muốn thoát?')){    
		                    	    $("#lecturers_id").val('');
		                    	    $("#namel").val('');
		                    	} 
	           		  		}
	           		  		else $('#namel').val(response.name);
	           		  	},
	           		  	error: function(xhr) {
	           		  		        		  
	           			}
	           		});
            	}
            });
            
            $('#uthu').on('change',function(){
            	$("#utietbd").val('');
            	$("#unamer").val('');
            });
            
			$('#utietbd').on('change',function(){
				$("#unamer").val('');
            });
          	
			$('#ulecturers_id').on('change',function(){
				$("#utietbd").val('');
            });
			
			$('#btnLuu').prop('disabled', true);
		    $('#usubject_id,#ulecturers_id,#unhom,#utth,#ustc,#umalop,#usiso,#uthu,#utietbd,#usotiet,#unamer').on('keyup change',function(){
		    	//if( $('#namer :selected').val()!="") alert('null');
            	
		        if ($('#usubject_id').val() != '' && $('#ulecturers_id').val() != '' && $('#unhom').val() != '' && $('#utth').val() != ''
		        	&& $('#ustc').val() != '' && $('#umalop').val() != '' && $('#usiso').val() != ''&& $('#usotiet').val() != '' ){
		            if($('#unamer').val() != '') $('#btnLuu').prop('disabled', false);
		        }
		        else{
		            $('#btnLuu').prop('disabled', true);
		        }
		    });
            
            //_________________________________________
            
            $('.delete').on('click',function(event){
            	var id = $(this).parent().find("#id").val();
            	alert(id);
            });
            
            
            //$('.btnadd').on('click',function(event){
            	//var inp = $(".form-control").val().trim();
                //if(inp==="") $("#btnluu").attr("disabled", true);
                //else $("#btnluu").removeAttr("disabled");
            //});
			
			
			$('#btnAdd').prop('disabled', true);
		    $('#subject_id,#lecturers_id,#nhom,#tth,#stc,#malop,#siso,#thu,#tietbd,#sotiet,#namer').on('keyup change',function(){
		    	//if( $('#namer :selected').val()!="") alert('null');
            	
		        if ($('#subject_id').val() != '' && $('#lecturers_id').val() != '' && $('#nhom').val() != '' && $('#tth').val() != ''
		        	&& $('#stc').val() != '' && $('#malop').val() != '' && $('#siso').val() != '' && $('#thu').val() != ''
		        		 && $('#namer').val() != '' && $('#sotiet').val() != '' && $('#tietbd').val() != ''){
		            $('#btnAdd').prop('disabled', false);
		        }
		        else{
		            $('#btnAdd').prop('disabled', true);
		        }
		    });
			
            $('.btnEdit').on('click',function(event){
            	//th:action="@/save" method="put"
            	///schule/(id=${schedule.id}
            	event.preventDefault();
            	var href = $(this).attr('href');
            	$.get(href, function(schules,status){
            		$('#id').val(schules.id);
            		//$('#uidky').val(schules.semestern);
            		$('#usubject_id').val(schules.subject_id);
            		$('#unames').val(schules.names);
            		$('#ulecturers_id').val(schules.lecturers_id);
            		$('#unamel').val(schules.namel);
            		$('#unhom').val(schules.nhom);
            		$('#utth').val(schules.tth);
            		$('#ustc').val(schules.stc);
            		$('#umalop').val(schules.malop);
            		$('#usiso').val(schules.siso);
            		$('#uthu').val(schules.thu);
            		//$('#utietbd').val(schules.tietbd);
            		$('#utietbd').append('<option selected="selected" value="'+schules.tietbd+'">'+schules.tietbd+'</option>');
            		$('#usotiet').val(schules.sotiet);
            		//$('#unamer').val(schules.namer);
            		$('#unamer').append('<option selected="selected" value="'+schules.namer+'">'+schules.namer+'</option>');
            	})
            	$('#myModal').modal();
            });
            $("#editForm").submit(function(event) {
    			// Prevent the form from submitting via the browser.
    			event.preventDefault();
    			var temp = 0;
    			var tempp = 0;
               	var nhom = $("#unhom").val();
               	var siso = $("#usiso").val();
               	if(!isNaN(nhom)) temp++;
               	if(!isNaN(siso)) tempp++;
               	if(temp==1 && tempp==1) ajaxPost();
               	if(temp==0){
               		$("#unhom").focus();
               		alert('Tên nhóm phải là số!');
               	}
               	if(tempp==0){
               		$("#usiso").focus();
               		alert('Sĩ số phải là số!');
               	}
               	
    			
    		});
            
            function ajaxPost() {

    			// PREPARE FORM DATA
    			var formData = {
    				id: $("#id").val(),
    				semestern: $("#uidky").val(),
    				subject_id : $("#usubject_id").val(),
    				names : $("#unames").val(),
    				lecturers_id: $("#ulecturers_id").val(),
    				namel: $("#unamel").val(),
    				nhom: $("#unhom").val(),
    				tth: $("#utth").val(),
    				stc: $("#ustc").val(),
    				malop: $("#umalop").val(),
    				siso: $("#usiso").val(),
    				thu: $("#uthu").val(),
    				tietbd: $("#utietbd").val(),
    				sotiet: $("#usotiet").val(),
    				namer: $("#unamer").val()
    			}

    			// DO POST
    			$.ajax({
    				type : "PUT",
    				contentType : "application/json",
    				url : "saveSchule",
    				data : JSON.stringify(formData),
    				dataType : 'json',
    				success : function(result) {
    					if (result.status == "success") {
    						alert("success!");
    					} else {
    						alert("Error!")
    					}
    					console.log(result);
    				},
    				error : function(e) {
    					alert("Sửa thành công!")
    				}
    			});

    		}
        });
        
        
		function exitT(){
			location.reload()
		}
        function editSchu(){
            var par = $(this).parent().parent(); 
	        var tdName = par.children("td:nth-child(1)");

            console.log(tdName.Json());
        }
        
    </script>
</body>
</html>